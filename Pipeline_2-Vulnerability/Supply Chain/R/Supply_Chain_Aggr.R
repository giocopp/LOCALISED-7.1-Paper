










### Merge
# Step 1: Prepare National-Level Data (Eurostat_Exp and Eurostat_Imp)
national_data <- Eurostat_Exp |>
  dplyr::full_join(Eurostat_Imp, by = c("NUTS_ID", "Sector")) |>
  dplyr::mutate(Country_ID = substr(NUTS_ID, 1, 2))  # Extract Country ID

# Step 2: Prepare Regional-Level Data (Eurostat_Road, Eurostat_Rail, RCI_rtp)
regional_data <- Eurostat_Road |>
  dplyr::full_join(Eurostat_Rail, by = "NUTS_ID") |>
  dplyr::full_join(RCI_rtp, by = c("NUTS_ID" = "RCI_code"))

# Step 3: Expand Regional Data to Include All Sectors
expanded_regional_data <- base_data |>
  dplyr::select(NUTS_ID) |>  # Get all regional codes
  dplyr::distinct() |> 
  tidyr::crossing(Sector = unique(national_data$Sector)) |>  # Create combinations
  dplyr::left_join(regional_data, by = "NUTS_ID") |>  # Add regional-level data
  dplyr::mutate(
    across(c(MWAY_Net, RL_Net, RT_Perf), ~ replace_na(.x, 0))  # Replace NAs with 0
  )

# Step 4: Combine National and Regional Data
final_data <- expanded_regional_data |>
  dplyr::mutate(Country_ID = substr(NUTS_ID, 1, 2)) |>  # Extract country ID from NUTS_ID
  dplyr::left_join(national_data, by = c("Country_ID" = "NUTS_ID", "Sector"))  # Join by country and sector

# Final Dataset: Ensure Desired Columns
SupCh_Index <- final_data |>
  dplyr::select(NUTS_ID, Sector, Exp, Imp, MWAY_Net, RL_Net, RT_Perf)